<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Agence Les Ecrins - Immobilier haut de gamme à Gordes et alentours. Découvrez nos biens immobiliers prestigieux." />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400&display=swap" rel="stylesheet"> <!-- Police principale pour h2 -->
    <link href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:ital,opsz,wght@0,6..96,400..900;1,6..96,400..900&family=DM+Serif+Text:ital@0;1&family=Lora:ital,wght@0,400..700;1,400..700&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <title>Agence Les Ecrins - Estimation</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="estimation.css">
</head>

<body>
    <header>
        <div class="header-top">
            <img src="https://i.imgur.com/xD59nhu.jpeg" alt="Logo Agence Les Écrins" class="founder-logo">
        </div>
        <div class="header-divider"></div>
        <div class="header-bottom">
            <button class="burger-menu">☰</button>
            <nav>
                <ul>
                    <li><a href="index.html">L'AGENCE</a></li>
                    <li><a href="biens-en-vente.html">BIENS EN VENTE</a></li>
                    <li><a href="services.html">SERVICES</a></li>
                    <li><a href="estimation.html" class="active">ESTIMATION</a></li>
                    <li><a href="contact.html">CONTACT</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>    
        <section class="estimation-section">
            <div class="estimation-content">
                <div class="estimation-text">
                    <p>Une estimation juste et précise est essentielle pour bien démarrer tout projet immobilier. Elle permet de définir la juste valeur de votre bien, en tenant compte de nombreux critères, tels que l’état du marché, l’emplacement, les caractéristiques spécifiques de votre propriété et son potentiel.</p>
                    <p>En effet, un prix de vente adéquat vous permet de vous positionner de manière stratégique face aux acheteurs et contribue également à optimiser la durée de commercialisation de votre bien, en vous assurant que la vente se fasse dans les meilleures conditions et dans un délai optimal.</p>
                    <p>En tant qu’expert du secteur, je m’engage à vous fournir une analyse complète et objective afin de vous aider à atteindre vos objectifs dans les meilleures conditions.</p>
                </div>
                <div class="estimation-image">
                    <button id="open-form">Démarrer l'estimation</button>
                </div>
            </div>
        </section>
    
        <div id="form-modal" class="modal">
            <div class="modal-content">
                <span class="close">×</span>
                <div id="form-container">
                    <form id="multi-step-form">
                        <!-- Étape 0 : Introduction -->
                        <div class="step active">
                            <div class="form-intro">
                                <p class="form-note">Chaque information demandée est utile pour affiner notre analyse, mais si certaines manquent, nous pourrons tout de même établir une première estimation. Nous vous recontacterons ensuite pour valider les détails et vous fournir une évaluation précise accompagnée d'un dossier complet.</p>
                                <button type="button" class="next start-form">Commencer le formulaire</button>
                                <p class="form-duration">Durée estimative : 3 minutes</p>
                            </div>
                        </div>
                    
                        <!-- Étape 1 : Informations personnelles -->
                        <div class="step">
                            <h2>Informations personnelles</h2>
                            <label for="full-name">Nom et prénom :</label>
                            <input type="text" name="full-name" id="full-name">
                            <label for="phone">Numéro de téléphone :</label>
                            <input type="tel" name="phone" id="phone">
                            <label for="email">Adresse e-mail :</label>
                            <input type="email" name="email" id="email">
                            <div class="button-container">
                                <button type="button" class="next">Suivant</button>
                            </div>
                        </div>
                    
                        <!-- Étape 2 : Informations sur le bien -->
                        <div class="step">
                            <h2>Informations sur le bien</h2>
                            <label for="property-address">Adresse du bien :</label>
                            <input type="text" name="property-address" id="property-address">
                            <label for="postal-code">Code postal :</label>
                            <input type="text" name="postal-code" id="postal-code">
                            <label for="city">Ville :</label>
                            <input type="text" name="city" id="city">
                            <label for="property-type">Typologie du bien :</label>
                            <select name="property-type" id="property-type-select">
                                <option value="">Sélectionnez une option</option>
                                <option value="maison">Maison</option>
                                <option value="appartement">Appartement</option>
                                <option value="terrain">Terrain</option>
                                <option value="autres">Autres</option>
                            </select>
                            <div class="button-container">
                                <button type="button" class="prev">Précédent</button>
                                <button type="button" class="next">Suivant</button>
                            </div>
                        </div>
                    
                        <!-- Étape 3 : Détails du bien (sera rempli dynamiquement) -->
                        <div class="step">
                            <h2>Détails du bien</h2>
                            <div id="dynamic-fields"></div>
                            <div class="button-container">
                                <button type="button" class="prev">Précédent</button>
                                <button type="button" class="next">Suivant</button>
                            </div>
                        </div>
                    
                        <!-- Étape 4 : Remarques -->
                        <div class="step">
                            <h2>Remarques</h2>
                            <label for="remarks">Remarques supplémentaires :</label>
                            <textarea name="remarks" id="remarks" rows="6" style="width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 5px; font-family: 'Lora', serif; font-size: 1em; background-color: #f9f9f9;"></textarea>
                            <div class="button-container submit-container">
                                <button type="button" id="submit-form">Envoyer le formulaire</button>
                            </div>
                        </div>
                    
                        <!-- Étape 5 : Confirmation -->
                        <div class="step">
                            <div class="confirmation-message">
                                <h2>Formulaire envoyé avec succès !</h2>
                                <p>Votre demande d’estimation a été bien reçue. Nous allons analyser les informations fournies et vous contacterons dans les meilleurs délais pour vous fournir une évaluation précise accompagnée d’un dossier complet.</p>
                                <p>Merci de votre confiance !</p>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-container">
            <p class="footer-text">© 2024 Agence Les Écrins. Tous droits réservés.</p>
            <div class="footer-links">
                <a href="documents/honoraires.pdf" target="_blank">Barème des honoraires</a>
                <a href="mentions-legales.html">Mentions légales</a>
            </div>
        </div>
    </footer>

<script>
    document.querySelector('.burger-menu').addEventListener('click', function() {
        document.querySelector('.header-bottom nav ul').classList.toggle('active');
    });

    const openForm = document.getElementById('open-form');
    const modal = document.getElementById('form-modal');
    const closeModal = document.querySelector('.close');
    const steps = document.querySelectorAll('.step');
    let currentStep = 0;
    let formData = {};

    function saveData() {
        const inputs = steps[currentStep].querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
            formData[input.name] = input.value;
        });
        console.log('Données sauvegardées pour l’étape', currentStep, formData);
    }

    function restoreData() {
        const inputs = steps[currentStep].querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
            if (formData[input.name]) {
                input.value = formData[input.name];
            }
        });
    }

    function generateDynamicFields() {
        const dynamicFieldsContainer = document.getElementById('dynamic-fields');
        dynamicFieldsContainer.innerHTML = ''; // Vider le conteneur

        const propertyType = formData['property-type'] || '';
        let fieldsHTML = '';

        if (propertyType === 'maison') {
            fieldsHTML = `
                <label for="construction-year">Année de construction :</label>
                <input type="number" name="construction-year" id="construction-year" min="1900" max="2025">
                <label for="rooms">Nombre de pièces :</label>
                <input type="number" name="rooms" id="rooms" min="1">
                <label for="living-area">Surface habitable (m²) :</label>
                <input type="number" name="living-area" id="living-area" min="0">
                <label for="outdoor-area">Surface extérieure (m²) :</label>
                <input type="number" name="outdoor-area" id="outdoor-area" min="0">
                <label for="annexes">Annexes (ex. : piscine, abri de jardin) :</label>
                <input type="text" name="annexes" id="annexes">
            `;
        } else if (propertyType === 'appartement') {
            fieldsHTML = `
                <label for="construction-year">Année de construction :</label>
                <input type="number" name="construction-year" id="construction-year" min="1900" max="2025">
                <label for="floor">Étage :</label>
                <input type="number" name="floor" id="floor" min="0">
                <label for="rooms">Nombre de pièces :</label>
                <input type="number" name="rooms" id="rooms" min="1">
                <label for="living-area">Surface habitable (m²) :</label>
                <input type="number" name="living-area" id="living-area" min="0">
                <label for="balcony">Présence d’un balcon ?</label>
                <select name="balcony" id="balcony">
                    <option value="">Sélectionnez une option</option>
                    <option value="oui">Oui</option>
                    <option value="non">Non</option>
                </select>
            `;
        } else if (propertyType === 'terrain') {
            fieldsHTML = `
                <label for="land-area">Surface du terrain (m²) :</label>
                <input type="number" name="land-area" id="land-area" min="0">
                <label for="constructible">Terrain constructible ?</label>
                <select name="constructible" id="constructible">
                    <option value="">Sélectionnez une option</option>
                    <option value="oui">Oui</option>
                    <option value="non">Non</option>
                </select>
                <label for="access">Accès (ex. : route, chemin) :</label>
                <input type="text" name="access" id="access">
            `;
        } else {
            fieldsHTML = `
                <label for="description">Description du bien :</label>
                <input type="text" name="description" id="description">
                <label for="area">Surface (m²) :</label>
                <input type="number" name="area" id="area" min="0">
            `;
        }

        dynamicFieldsContainer.innerHTML = fieldsHTML;
        restoreData(); // Restaurer les données si elles existent
    }

    openForm.addEventListener('click', () => {
        modal.style.display = 'block';
        document.body.style.overflow = 'hidden';
    });

    closeModal.addEventListener('click', () => {
        modal.style.display = 'none';
        currentStep = 0;
        steps.forEach(step => step.classList.remove('active', 'next-slide', 'prev-slide'));
        steps[currentStep].classList.add('active');
        formData = {};
        document.body.style.overflow = 'auto';
    });

    // Écouteur pour le changement de "Typologie du bien"
    const propertyTypeSelect = document.getElementById('property-type-select');
    propertyTypeSelect.addEventListener('change', () => {
        saveData(); // Sauvegarder le nouveau type de bien
        if (currentStep === 2) { // Si on est à l’étape 3
            generateDynamicFields();
        }
    });

    modal.addEventListener('click', (event) => {
        const button = event.target.closest('button');
        if (!button) return;

        console.log('Bouton cliqué :', button.className || button.id, 'sur l’étape', currentStep);
        if (button.classList.contains('next') || button.classList.contains('start-form')) {
            if (currentStep < steps.length - 2) {
                saveData();
                steps[currentStep].classList.remove('active');
                steps[currentStep].classList.add('next-slide'); // Animation de sortie
                currentStep++;
                steps[currentStep].classList.add('active', 'prev-slide'); // Animation d’entrée
                if (currentStep === 2) { // Étape 3 (Détails du bien)
                    generateDynamicFields();
                }
                restoreData();

                // Retirer les classes d’animation après la transition
                setTimeout(() => {
                    steps[currentStep].classList.remove('prev-slide');
                    steps[currentStep - 1].classList.remove('next-slide');
                }, 500); // Correspond à la durée de l’animation (0.5s)

                console.log('Passage à l’étape', currentStep);
            }
        } else if (button.classList.contains('prev')) {
            if (currentStep > 0) {
                saveData();
                steps[currentStep].classList.remove('active');
                steps[currentStep].classList.add('prev-slide'); // Animation de sortie
                currentStep--;
                steps[currentStep].classList.add('active', 'next-slide'); // Animation d’entrée
                if (currentStep === 2) { // Étape 3 (Détails du bien)
                    generateDynamicFields();
                }
                restoreData();

                // Retirer les classes d’animation après la transition
                setTimeout(() => {
                    steps[currentStep].classList.remove('next-slide');
                    steps[currentStep + 1].classList.remove('prev-slide');
                }, 500); // Correspond à la durée de l’animation (0.5s)

                console.log('Retour à l’étape', currentStep);
            }
        } else if (button.id === 'submit-form') {
            saveData();
            console.log('Formulaire envoyé :', formData);
            steps[currentStep].classList.remove('active');
            steps[currentStep].classList.add('next-slide'); // Animation de sortie
            currentStep++;
            steps[currentStep].classList.add('active', 'prev-slide'); // Animation d’entrée
            console.log('Passage à l’étape de confirmation', currentStep);

            // Retirer les classes d’animation après la transition
            setTimeout(() => {
                steps[currentStep].classList.remove('prev-slide');
                steps[currentStep - 1].classList.remove('next-slide');
            }, 500); // Correspond à la durée de l’animation (0.5s)
        }
    });

    window.addEventListener('click', (event) => {
        if (event.target === modal) {
            modal.style.display = 'none';
            currentStep = 0;
            steps.forEach(step => step.classList.remove('active', 'next-slide', 'prev-slide'));
            steps[currentStep].classList.add('active');
            formData = {};
            document.body.style.overflow = 'auto';
        }
    });
</script>
</body>
</html>
